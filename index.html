<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <title>YAMINABE ÂÆöÁÇπÊ§úÁ¥¢„Ç®„É≥„Ç∏„É≥</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 20px auto;
      max-width: 600px;
      color: #222;
      background: #f9f9f9;
    }

    h1 {
      font-weight: 600;
      font-size: 1.5rem;
      margin-bottom: 1rem;
      text-align: center;
    }

    button {
      background-color: #007acc;
      border: none;
      padding: 10px 15px;
      color: white;
      font-weight: 600;
      border-radius: 4px;
      cursor: pointer;
      margin: 1rem 0;
      width: 100%;
      max-width: 200px;
      display: block;
      margin-left: auto;
      margin-right: auto;
      transition: background-color 0.2s ease;
    }

    button:hover {
      background-color: #005ea3;
    }

    #status, #result {
      text-align: center;
      margin-top: 0.5rem;
      margin-bottom: 1rem;
      font-weight: 500;
      color: #555;
    }

    #top-dropdowns, #agent-dropdown-container {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .dropdown {
      position: relative;
      flex: 1 1 150px;
      max-width: 180px;
    }

    .dropdown-selected {
      background: white;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 8px 12px;
      cursor: pointer;
      user-select: none;
      font-weight: 500;
      color: #222;
    }

    .dropdown-options {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #ccc;
      border-radius: 4px;
      max-height: 150px;
      overflow-y: auto;
      z-index: 10;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .dropdown-options div {
      padding: 8px 12px;
      cursor: pointer;
      font-size: 0.95rem;
      color: #222;
    }

    .dropdown-options div:hover {
      background: #e6f0ff;
    }

    #videos {
      margin-top: 1rem;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
    }

    #videos iframe {
      border-radius: 6px;
      border: 1px solid #ddd;
    }
  </style>
</head>

<body>

  <h1>Valorant ÂÆöÁÇπÂÖ±Êúâ„ÉÑ„Éº„É´Ôºà‰∫åÊÆµÈöé„Ç®„Éº„Ç∏„Çß„É≥„ÉàÈÅ∏ÊäûÔºâ</h1>

  <button onclick="login()">Google„É≠„Ç∞„Ç§„É≥</button>
  <p id="status">Êú™„É≠„Ç∞„Ç§„É≥</p>

  <!-- ‰∏äÊÆµ„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ -->
  <div id="top-dropdowns"></div>

  <!-- ‰∏ãÊÆµ„Ç®„Éº„Ç∏„Çß„É≥„Éà„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ -->
  <div id="agent-dropdown-container"></div>

  <button id="search-button" onclick="search()">Ê§úÁ¥¢</button>

  <p id="result"></p>
  <div id="videos"></div>

  <script>
    const CHANNEL_ID = 'UCtKIv1NO4xZMEqe9ESfn2qA';
    const CLIENT_ID = '1036652484090-5pcett8ccam91f8p669iui71dr40tvk7.apps.googleusercontent.com';
    const API_KEY = 'AIzaSyAppfK7wHG6EenDPEwmiW6H2d_zBSDD93g';
    const SCOPES = 'https://www.googleapis.com/auth/youtube.readonly';

    let accessToken = '';
    let allVideos = [];

    const agentsByRole = {
      '„Éá„É•„Ç®„É™„Çπ„Éà': ['„Ç∏„Çß„ÉÉ„Éà', '„Éï„Çß„Éã„ÉÉ„ÇØ„Çπ', '„É¨„Ç§„Ç∫', '„É¨„Ç§„Éä', '„É®„É´', '„Éç„Ç™„É≥', '„Ç¶„Çß„Ç§„É¨„Ç§'],
      '„Ç§„Éã„Ç∑„Ç®„Éº„Çø„Éº': ['„ÇΩ„Éº„É¥„Ç°', '„Çπ„Ç´„Ç§', 'KAY/O', '„Éï„Çß„Ç§„Éâ', '„Ç≤„ÉÉ„Ç≥„Éº', '„ÉÜ„Éõ'],
      '„Çª„É≥„ÉÅ„Éç„É´': ['„Ç≠„É´„Ç∏„Éß„Ç§', '„Çµ„Ç§„Éï„Ç°„Éº', '„ÉÅ„Çß„É≥„Éê„Éº', '„Çª„Éº„Ç∏', '„É¥„Ç°„Ç§„Çπ', '„Éá„ÉÉ„Éâ„É≠„ÉÉ„ÇØ'],
      '„Ç≥„É≥„Éà„É≠„Éº„É©„Éº': ['„Éñ„É™„É†„Çπ„Éà„Éº„É≥', '„Ç™„Éº„É°„É≥', '„É¥„Ç°„Ç§„Éë„Éº', '„Ç¢„Çπ„Éà„É©', '„Éè„Éº„Éê„Éº']
    };

    const maps = ['„Ç¢„Çª„É≥„Éà', '„Çπ„Éó„É™„ÉÉ„Éà', '„Éò„Ç§„É¥„É≥', '„Éê„Ç§„É≥„Éâ', '„Ç¢„Ç§„Çπ„Éú„ÉÉ„ÇØ„Çπ', '„Éñ„É™„Éº„Ç∫', '„Éï„É©„ÇØ„ÉÅ„É£„Éº', '„Éë„Éº„É´', '„É≠„Éº„Çø„Çπ', '„Çµ„É≥„Çª„ÉÉ„Éà', '„Ç¢„Éì„Çπ', '„Ç´„É≠„Éº„Éâ'];
    const spots = ['AÊîª„ÇÅ', 'AÂÆà„Çä', 'BÊîª„ÇÅ', 'BÂÆà„Çä', 'CÊîª„ÇÅ', 'CÂÆà„Çä', 'MidÊîª„ÇÅ', 'MidÂÆà„Çä'];

    const selections = { role: '', agent: '', map: '', spot: '' };

    function createDropdown(id, options, parentId) {
      const container = document.createElement('div');
      container.className = 'dropdown';

      const selected = document.createElement('div');
      selected.className = 'dropdown-selected';
      selected.setAttribute('data-type', id);
      selected.innerText = `${id}ÈÅ∏Êäû`;
      selected.addEventListener('click', () => toggleDropdown(id));

      const optionsDiv = document.createElement('div');
      optionsDiv.className = 'dropdown-options';
      optionsDiv.id = `${id}-options`;

      options.forEach(option => {
        const opt = document.createElement('div');
        opt.innerText = option;
        opt.onclick = () => selectOption(id, option);
        optionsDiv.appendChild(opt);
      });

      container.appendChild(selected);
      container.appendChild(optionsDiv);
      document.getElementById(parentId).appendChild(container);
    }

    function selectOption(type, value) {
      const dropdown = document.querySelector(`.dropdown-selected[data-type="${type}"]`);
      if (!dropdown) {
        console.error(`Dropdown not found for type: ${type}`);
        return;
      }
      dropdown.innerText = value;
      selections[type] = value;
      document.getElementById(`${type}-options`).style.display = 'none';

      if (type === 'role') {
        updateAgentDropdown(value);
      }
    }

    function toggleDropdown(type) {
      const options = document.getElementById(`${type}-options`);
      options.style.display = options.style.display === 'block' ? 'none' : 'block';
    }

    function updateAgentDropdown(role) {
      const agentContainer = document.getElementById('agent-dropdown-container');
      agentContainer.innerHTML = '';
      selections.agent = '';

      if (role && agentsByRole[role]) {
        createDropdown('agent', agentsByRole[role], 'agent-dropdown-container');
      }
    }

    function login() {
      const tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: (response) => {
          if (response.access_token) {
            accessToken = response.access_token;
            document.getElementById('status').innerText = '‚úÖ „É≠„Ç∞„Ç§„É≥ÊàêÂäü';
            loadVideos();
          } else {
            document.getElementById('status').innerText = '‚ùå „É≠„Ç∞„Ç§„É≥Â§±Êïó';
          }
        },
      });

      tokenClient.requestAccessToken();
    }

    async function loadVideos(pageToken = '') {
      gapi.load('client', async () => {
        await gapi.client.init({
          apiKey: API_KEY,
          discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest'],
        });

        gapi.client.setToken({ access_token: accessToken });

        const response = await gapi.client.youtube.search.list({
          part: 'snippet',
          channelId: CHANNEL_ID,
          maxResults: 50,
          pageToken: pageToken,
          type: 'video',
          order: 'date',
        });

        allVideos = allVideos.concat(response.result.items);

        if (response.result.nextPageToken) {
          await loadVideos(response.result.nextPageToken);
        } else {
          document.getElementById('status').innerText = `‚úÖ ${allVideos.length}‰ª∂„ÅÆÂãïÁîª„ÇíÂèñÂæó„Åó„Åæ„Åó„Åü`;
          displayVideos(allVideos);
        }
      });
    }

    function displayVideos(videos) {
      const html = videos.map(item => {
        if (!item.id || !item.id.videoId) return '';

        const videoId = item.id.videoId;
        const title = item.snippet.title;
        return `<div><p>${title}</p><iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe></div>`;
      }).join('');

      document.getElementById('videos').innerHTML = html;
    }

    function search() {
      const { agent, map, spot } = selections;
      const query = `${agent} ${map} ${spot}`.toLowerCase().trim();
      document.getElementById('result').innerText = `üîç Ê§úÁ¥¢Êù°‰ª∂: ${query}`;

      const filtered = allVideos.filter(v => {
        const title = v.snippet.title.toLowerCase();
        return title.includes(agent.toLowerCase()) && title.includes(map.toLowerCase()) && title.includes(spot.toLowerCase());
      });

      displayVideos(filtered);
    }

    // ÂàùÊúüÂåñ
    createDropdown('role', Object.keys(agentsByRole), 'top-dropdowns');
    createDropdown('map', maps, 'top-dropdowns');
    createDropdown('spot', spots, 'top-dropdowns');
  </script>

</body>

</html>
